# Hidden Shield æ’ä»¶å¼€å‘æŒ‡å—

> ç‰ˆæœ¬ï¼š1.0.0  
> æ›´æ–°æ—¶é—´ï¼š2025-10-06  
> é€‚ç”¨äºï¼šHidden Shield v0.0.1+

---

## ğŸ“š ç›®å½•

1. [æ’ä»¶ç³»ç»Ÿæ¦‚è¿°](#1-æ’ä»¶ç³»ç»Ÿæ¦‚è¿°)
2. [å¼€å‘ç¯å¢ƒå‡†å¤‡](#2-å¼€å‘ç¯å¢ƒå‡†å¤‡)
3. [å¿«é€Ÿå¼€å§‹](#3-å¿«é€Ÿå¼€å§‹)
4. [æ’ä»¶é¡¹ç›®ç»“æ„](#4-æ’ä»¶é¡¹ç›®ç»“æ„)
5. [é…ç½®æ–‡ä»¶è¯¦è§£](#5-é…ç½®æ–‡ä»¶è¯¦è§£)
6. [æ’ä»¶ç”Ÿå‘½å‘¨æœŸ](#6-æ’ä»¶ç”Ÿå‘½å‘¨æœŸ)
7. [æ•°æ®è¾“å‡ºè§„èŒƒ](#7-æ•°æ®è¾“å‡ºè§„èŒƒ)
8. [è°ƒè¯•ä¸æµ‹è¯•](#8-è°ƒè¯•ä¸æµ‹è¯•)
9. [æ‰“åŒ…ä¸å‘å¸ƒ](#9-æ‰“åŒ…ä¸å‘å¸ƒ)
10. [æœ€ä½³å®è·µ](#10-æœ€ä½³å®è·µ)
11. [å¸¸è§é—®é¢˜](#11-å¸¸è§é—®é¢˜)

---

## 1. æ’ä»¶ç³»ç»Ÿæ¦‚è¿°

### 1.1 ä»€ä¹ˆæ˜¯ Hidden Shield æ’ä»¶ï¼Ÿ

Hidden Shield æ’ä»¶æ˜¯ç‹¬ç«‹çš„å®‰å…¨å·¥å…·æ¨¡å—ï¼Œå¯ä»¥æ‰©å±•ç³»ç»Ÿçš„æ‰«æå’Œæ£€æµ‹èƒ½åŠ›ã€‚æ’ä»¶å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

- âœ… **ç‹¬ç«‹è¿è¡Œ**ï¼šæ¯ä¸ªæ’ä»¶æ˜¯ç‹¬ç«‹çš„å¯æ‰§è¡Œç¨‹åº
- âœ… **æ ‡å‡†åŒ–æ¥å£**ï¼šé€šè¿‡æ ‡å‡†è¾“å…¥/è¾“å‡ºä¸ç³»ç»Ÿäº¤äº’
- âœ… **å¤šè¯­è¨€æ”¯æŒ**ï¼šæ”¯æŒ Goã€Pythonã€Node.js ç­‰è¿è¡Œæ—¶
- âœ… **æ²™ç®±éš”ç¦»**ï¼šæ’ä»¶åœ¨éš”ç¦»ç¯å¢ƒä¸­è¿è¡Œï¼Œä¿è¯ç³»ç»Ÿå®‰å…¨
- âœ… **çƒ­æ’æ‹”**ï¼šæ— éœ€é‡å¯ç³»ç»Ÿå³å¯å®‰è£…/å¸è½½æ’ä»¶

### 1.2 æ’ä»¶åˆ†ç±»

| ç±»åˆ« | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| **scan** | ä¸»åŠ¨æ‰«æ | ç«¯å£æ‰«æã€æ¼æ´æ‰«æ |
| **fingerprint** | æŒ‡çº¹è¯†åˆ« | Webæ¡†æ¶è¯†åˆ«ã€è®¾å¤‡æŒ‡çº¹ |
| **asset** | èµ„äº§æ”¶é›† | å­åŸŸåæ”¶é›†ã€IPæ¢æµ‹ |
| **exploit** | æ¼æ´åˆ©ç”¨ | SQLæ³¨å…¥ã€XSSæµ‹è¯• |
| **report** | æŠ¥å‘Šç”Ÿæˆ | PDFæŠ¥å‘Šã€Excelå¯¼å‡º |

### 1.3 æ”¯æŒçš„è¿è¡Œæ—¶

- **Go** (æ¨è)ï¼šé«˜æ€§èƒ½ã€ç¼–è¯‘å‹ï¼Œé€‚åˆæ‰«æç±»æ’ä»¶
- **Python**ï¼šä¸°å¯Œçš„åº“ï¼Œé€‚åˆæ•°æ®å¤„ç†å’ŒAIåˆ†æ
- **Node.js**ï¼šé€‚åˆWebæ¥å£å’Œå¼‚æ­¥ä»»åŠ¡
- **Shell**ï¼šé€‚åˆç³»ç»Ÿé›†æˆå’Œç®€å•è„šæœ¬

---

## 2. å¼€å‘ç¯å¢ƒå‡†å¤‡

### 2.1 å¿…éœ€å·¥å…·

```bash
# Go å¼€å‘ç¯å¢ƒ (æ¨è 1.19+)
go version

# æˆ– Python ç¯å¢ƒ (æ¨è 3.8+)
python --version

# æˆ– Node.js ç¯å¢ƒ (æ¨è 16+)
node --version
```

### 2.2 å…‹éš†å¼€å‘æ¨¡æ¿

```bash
# è¿›å…¥æ’ä»¶å¼€å‘ç›®å½•
cd plugins/

# æ–¹å¼1: å¤åˆ¶ç°æœ‰æ’ä»¶ä½œä¸ºæ¨¡æ¿
cp -r asset_collector my_plugin

# æ–¹å¼2: ä»é›¶åˆ›å»º
mkdir my_plugin && cd my_plugin
```

### 2.3 å®‰è£…å¼€å‘å·¥å…·ï¼ˆå¯é€‰ï¼‰

```bash
# æ’ä»¶éªŒè¯å·¥å…·
go install github.com/hidden-shield/plugin-validator@latest

# æ’ä»¶æ‰“åŒ…å·¥å…·
go install github.com/hidden-shield/plugin-packager@latest
```

---

## 3. å¿«é€Ÿå¼€å§‹

### 3.1 åˆ›å»ºç¬¬ä¸€ä¸ªæ’ä»¶ï¼ˆGoï¼‰

**æ­¥éª¤1ï¼šåˆ›å»ºé¡¹ç›®ç»“æ„**

```bash
mkdir my_scanner && cd my_scanner
go mod init my_scanner
```

**æ­¥éª¤2ï¼šç¼–å†™ main.go**

```go
package main

import (
	"encoding/json"
	"fmt"
	"os"
)

type Result struct {
	Status  string                 `json:"status"`
	Message string                 `json:"message"`
	Data    map[string]interface{} `json:"data"`
}

func main() {
	// 1. è·å–ç›®æ ‡å‚æ•°
	if len(os.Args) < 2 {
		outputError("ç¼ºå°‘ç›®æ ‡å‚æ•°")
		os.Exit(1)
	}
	target := os.Args[1]

	// 2. æ‰§è¡Œæ‰«æé€»è¾‘
	fmt.Fprintf(os.Stderr, "INFO: å¼€å§‹æ‰«æç›®æ ‡ %s\n", target)
	
	// TODO: å®ç°ä½ çš„æ‰«æé€»è¾‘
	data := map[string]interface{}{
		"target":    target,
		"ports":     []int{80, 443, 8080},
		"timestamp": "2025-10-06T00:00:00Z",
	}

	// 3. è¾“å‡ºç»“æœ
	outputSuccess("æ‰«æå®Œæˆ", data)
}

func outputSuccess(message string, data map[string]interface{}) {
	result := Result{
		Status:  "success",
		Message: message,
		Data:    data,
	}
	json.NewEncoder(os.Stdout).Encode(result)
}

func outputError(message string) {
	result := Result{
		Status:  "error",
		Message: message,
		Data:    nil,
	}
	json.NewEncoder(os.Stdout).Encode(result)
}
```

**æ­¥éª¤3ï¼šåˆ›å»º metadata.json**

```json
{
  "name": "æˆ‘çš„æ‰«æå™¨",
  "key": "my_scanner",
  "category": "scan",
  "version": "1.0.0",
  "author": "Your Name",
  "description": "è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹æ‰«ææ’ä»¶",
  "tags": ["æ‰«æ", "ç¤ºä¾‹"],
  "runtime": "go",
  "entry": "main.go",
  "permissions": {
    "network": ["*"],
    "filesystem": [],
    "system": ["tcp_connect"]
  },
  "config": {
    "timeout": 60,
    "maxWorkers": 10
  },
  "inputFormat": "IPåœ°å€æˆ–åŸŸå",
  "outputFormat": "json"
}
```

**æ­¥éª¤4ï¼šæµ‹è¯•è¿è¡Œ**

```bash
go run main.go example.com
```

**é¢„æœŸè¾“å‡ºï¼š**
```json
{
  "status": "success",
  "message": "æ‰«æå®Œæˆ",
  "data": {
    "target": "example.com",
    "ports": [80, 443, 8080],
    "timestamp": "2025-10-06T00:00:00Z"
  }
}
```

---

## 4. æ’ä»¶é¡¹ç›®ç»“æ„

### 4.1 æ ‡å‡†ç»“æ„ï¼ˆGoæ’ä»¶ï¼‰

```
my_plugin/
â”œâ”€â”€ main.go                 # ä¸»ç¨‹åºå…¥å£ (å¿…éœ€)
â”œâ”€â”€ go.mod                  # Goæ¨¡å—ä¾èµ– (å¿…éœ€)
â”œâ”€â”€ go.sum                  # ä¾èµ–æ ¡éªŒæ–‡ä»¶
â”œâ”€â”€ metadata.json           # æ’ä»¶å…ƒæ•°æ® (å¿…éœ€)
â”œâ”€â”€ config.json             # é»˜è®¤é…ç½®æ–‡ä»¶ (å¯é€‰)
â”œâ”€â”€ README.md               # æ’ä»¶è¯´æ˜æ–‡æ¡£ (æ¨è)
â”œâ”€â”€ CHANGELOG.md            # ç‰ˆæœ¬æ›´æ–°æ—¥å¿— (æ¨è)
â”œâ”€â”€ config/                 # é…ç½®æ¨¡å—
â”‚   â”œâ”€â”€ config.go
â”‚   â””â”€â”€ config.json
â”œâ”€â”€ modules/                # å­æ¨¡å—ç›®å½•
â”‚   â”œâ”€â”€ scanner/
â”‚   â”‚   â””â”€â”€ scanner.go
â”‚   â””â”€â”€ parser/
â”‚       â””â”€â”€ parser.go
â”œâ”€â”€ types/                  # æ•°æ®ç±»å‹å®šä¹‰
â”‚   â””â”€â”€ types.go
â”œâ”€â”€ utils/                  # å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ utils.go
â”œâ”€â”€ wordlists/              # å­—å…¸æ–‡ä»¶
â”‚   â””â”€â”€ common.txt
â”œâ”€â”€ payloads/               # æµ‹è¯•è½½è·
â”‚   â””â”€â”€ xss.txt
â””â”€â”€ tests/                  # å•å…ƒæµ‹è¯•
    â””â”€â”€ scanner_test.go
```

### 4.2 Pythonæ’ä»¶ç»“æ„

```
my_plugin/
â”œâ”€â”€ main.py                 # ä¸»ç¨‹åºå…¥å£ (å¿…éœ€)
â”œâ”€â”€ requirements.txt        # Pythonä¾èµ– (å¿…éœ€)
â”œâ”€â”€ metadata.json           # æ’ä»¶å…ƒæ•°æ® (å¿…éœ€)
â”œâ”€â”€ config.json             # é»˜è®¤é…ç½®
â”œâ”€â”€ README.md
â”œâ”€â”€ modules/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ scanner.py
â””â”€â”€ tests/
    â””â”€â”€ test_scanner.py
```

### 4.3 Node.jsæ’ä»¶ç»“æ„

```
my_plugin/
â”œâ”€â”€ index.js                # ä¸»ç¨‹åºå…¥å£ (å¿…éœ€)
â”œâ”€â”€ package.json            # npmé…ç½® (å¿…éœ€)
â”œâ”€â”€ metadata.json           # æ’ä»¶å…ƒæ•°æ® (å¿…éœ€)
â”œâ”€â”€ config.json
â”œâ”€â”€ README.md
â”œâ”€â”€ src/
â”‚   â””â”€â”€ scanner.js
â””â”€â”€ tests/
    â””â”€â”€ scanner.test.js
```

---

## 5. é…ç½®æ–‡ä»¶è¯¦è§£

### 5.1 metadata.jsonï¼ˆæ’ä»¶å…ƒæ•°æ®ï¼‰

**å®Œæ•´ç¤ºä¾‹ï¼š**

```json
{
  "name": "ç«¯å£æ‰«æå™¨",
  "key": "port_scanner",
  "category": "scan",
  "version": "1.2.0",
  "author": "Security Team <security@example.com>",
  "description": "é«˜æ€§èƒ½ç«¯å£æ‰«æå·¥å…·ï¼Œæ”¯æŒTCP/UDPæ‰«æå’ŒæœåŠ¡è¯†åˆ«",
  "tags": ["ç«¯å£æ‰«æ", "TCP", "UDP", "æœåŠ¡è¯†åˆ«"],
  "runtime": "go",
  "entry": "main.go",
  "icon": "data:image/svg+xml;base64,...",
  "homepage": "https://github.com/your-org/port-scanner",
  "license": "MIT",
  
  "permissions": {
    "network": ["*"],
    "filesystem": ["/tmp/scanner/*", "output/*"],
    "system": ["tcp_connect", "udp_send", "dns_query"],
    "data": ["read", "write"]
  },
  
  "dependencies": [
    "github.com/projectdiscovery/naabu@v2.0.0",
    "golang.org/x/net"
  ],
  
  "config": {
    "timeout": 300,
    "maxWorkers": 50,
    "retryTimes": 3,
    "ports": "1-65535",
    "scanType": "syn",
    "serviceDetect": true
  },
  
  "inputFormat": "IPåœ°å€ã€CIDRã€åŸŸå",
  "outputFormat": "json",
  "estimatedTime": "1-5åˆ†é’Ÿï¼ˆè§†ç›®æ ‡è§„æ¨¡ï¼‰",
  
  "features": [
    "æ”¯æŒTCPå’ŒUDPæ‰«æ",
    "æœåŠ¡ç‰ˆæœ¬æ£€æµ‹",
    "è‡ªåŠ¨æ’é™¤CDN",
    "æ”¯æŒè‡ªå®šä¹‰ç«¯å£èŒƒå›´"
  ],
  
  "changelog": [
    {
      "version": "1.2.0",
      "date": "2025-10-01",
      "changes": [
        "æ–°å¢æœåŠ¡æŒ‡çº¹è¯†åˆ«",
        "ä¼˜åŒ–æ‰«æé€Ÿåº¦ï¼ˆæå‡30%ï¼‰",
        "ä¿®å¤UDPæ‰«æbug"
      ]
    }
  ]
}
```

**å­—æ®µè¯´æ˜ï¼š**

| å­—æ®µ | ç±»å‹ | å¿…éœ€ | è¯´æ˜ |
|------|------|------|------|
| `name` | string | âœ… | æ’ä»¶æ˜¾ç¤ºåç§° |
| `key` | string | âœ… | æ’ä»¶å”¯ä¸€æ ‡è¯†ï¼ˆå°å†™å­—æ¯+ä¸‹åˆ’çº¿ï¼‰ |
| `category` | string | âœ… | æ’ä»¶åˆ†ç±»ï¼ˆscan/fingerprint/asset/exploit/reportï¼‰ |
| `version` | string | âœ… | ç‰ˆæœ¬å·ï¼ˆéµå¾ªè¯­ä¹‰åŒ–ç‰ˆæœ¬ï¼‰ |
| `author` | string | âœ… | ä½œè€…ä¿¡æ¯ |
| `description` | string | âœ… | æ’ä»¶æè¿°ï¼ˆ200å­—ä»¥å†…ï¼‰ |
| `tags` | array | âœ… | æ ‡ç­¾ï¼ˆç”¨äºæœç´¢ï¼‰ |
| `runtime` | string | âœ… | è¿è¡Œæ—¶ï¼ˆgo/python/nodejs/shellï¼‰ |
| `entry` | string | âœ… | å…¥å£æ–‡ä»¶ |
| `permissions` | object | âŒ | æƒé™å£°æ˜ |
| `dependencies` | array | âŒ | ä¾èµ–åˆ—è¡¨ |
| `config` | object | âŒ | é»˜è®¤é…ç½® |
| `inputFormat` | string | âŒ | è¾“å…¥æ ¼å¼è¯´æ˜ |
| `outputFormat` | string | âŒ | è¾“å‡ºæ ¼å¼ï¼ˆjson/text/xmlï¼‰ |
| `features` | array | âŒ | åŠŸèƒ½ç‰¹æ€§åˆ—è¡¨ |
| `changelog` | array | âŒ | ç‰ˆæœ¬æ›´æ–°æ—¥å¿— |

### 5.2 config.jsonï¼ˆè¿è¡Œæ—¶é…ç½®ï¼‰

```json
{
  "timeout": 300,
  "maxWorkers": 10,
  "retryTimes": 3,
  "debug": false,
  
  "scanner": {
    "ports": "80,443,8080-8090",
    "threads": 50,
    "scanType": "syn"
  },
  
  "output": {
    "format": "json",
    "path": "./output",
    "verbose": true
  },
  
  "integrations": {
    "fofa": {
      "enabled": true,
      "email": "${FOFA_EMAIL}",
      "key": "${FOFA_KEY}"
    }
  }
}
```

**æ”¯æŒç¯å¢ƒå˜é‡**ï¼šä½¿ç”¨ `${VAR_NAME}` è¯­æ³•å¼•ç”¨ç¯å¢ƒå˜é‡ã€‚

---

## 6. æ’ä»¶ç”Ÿå‘½å‘¨æœŸ

### 6.1 æ‰§è¡Œæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç³»ç»Ÿè°ƒåº¦å™¨      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. å‚æ•°éªŒè¯     â”‚  æ£€æŸ¥ç›®æ ‡ã€é…ç½®ã€æƒé™
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. ç¯å¢ƒå‡†å¤‡     â”‚  åŠ è½½é…ç½®ã€åˆå§‹åŒ–èµ„æº
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. æ’ä»¶æ‰§è¡Œ     â”‚  main.go / main.py å…¥å£
â”‚                 â”‚  - æ¥æ”¶å‚æ•°ï¼ˆå‘½ä»¤è¡Œå‚æ•°ï¼‰
â”‚                 â”‚  - æ‰§è¡Œä¸šåŠ¡é€»è¾‘
â”‚                 â”‚  - è¾“å‡ºè¿›åº¦ï¼ˆstderrï¼‰
â”‚                 â”‚  - è¾“å‡ºç»“æœï¼ˆstdoutï¼‰
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. ç»“æœå¤„ç†     â”‚  è§£æJSONã€ä¿å­˜æ•°æ®åº“
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. æ¸…ç†èµ„æº     â”‚  å…³é—­è¿æ¥ã€åˆ é™¤ä¸´æ—¶æ–‡ä»¶
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 è¾“å…¥å‚æ•°

**å‘½ä»¤è¡Œå‚æ•°ï¼š**

```bash
# åŸºæœ¬å½¢å¼
./my_plugin <target> [options]

# ç¤ºä¾‹
./port_scanner 192.168.1.1
./subdomain_finder example.com
./asset_collector "äº¬ä¸œé›†å›¢"
```

**ç¯å¢ƒå˜é‡ï¼š**

ç³»ç»Ÿä¼šè‡ªåŠ¨æ³¨å…¥ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

```bash
HS_SCAN_ID=154d04f43a31056db554919e749a4517     # æ‰«æä»»åŠ¡ID
HS_PROJECT_ID=a88976852b32c0efcefe51e4b5feff1c  # é¡¹ç›®ID
HS_GATEWAY_URL=http://127.0.0.1:8080           # ç½‘å…³åœ°å€
HS_CONFIG_PATH=/path/to/config.json            # é…ç½®æ–‡ä»¶è·¯å¾„
```

### 6.3 è¾“å‡ºè§„èŒƒ

**æ ‡å‡†è¾“å‡ºï¼ˆstdoutï¼‰**ï¼šJSONæ ¼å¼çš„ç»“æœæ•°æ®

```json
{
  "status": "success",
  "message": "æ‰«æå®Œæˆ",
  "data": {
    "target": "example.com",
    "results": []
  }
}
```

**æ ‡å‡†é”™è¯¯ï¼ˆstderrï¼‰**ï¼šæ—¥å¿—å’Œè¿›åº¦ä¿¡æ¯

```
INFO: å¼€å§‹æ‰«æ example.com
INFO: å‘ç° 3 ä¸ªå¼€æ”¾ç«¯å£
WARN: ç«¯å£ 22 å“åº”è¶…æ—¶
ERROR: è¿æ¥è¢«æ‹’ç»
```

---

## 7. æ•°æ®è¾“å‡ºè§„èŒƒ

### 7.1 é€šç”¨è¾“å‡ºæ ¼å¼

```json
{
  "status": "success|error|warning",
  "message": "æ“ä½œæè¿°",
  "data": {
    // ä¸šåŠ¡æ•°æ®
  },
  "metadata": {
    "version": "1.0.0",
    "timestamp": "2025-10-06T00:00:00Z",
    "duration": 120.5,
    "target": "example.com"
  }
}
```

### 7.2 æ‰«æç±»æ’ä»¶è¾“å‡º

```json
{
  "status": "success",
  "message": "ç«¯å£æ‰«æå®Œæˆ",
  "data": {
    "target": "192.168.1.1",
    "open_ports": [
      {
        "port": 80,
        "protocol": "tcp",
        "service": "http",
        "version": "nginx/1.18.0",
        "banner": "HTTP/1.1 200 OK"
      },
      {
        "port": 443,
        "protocol": "tcp",
        "service": "https",
        "version": "nginx/1.18.0",
        "ssl": {
          "issuer": "Let's Encrypt",
          "expires": "2026-01-01"
        }
      }
    ],
    "closed_ports": 65533,
    "filtered_ports": 0
  },
  "metadata": {
    "scan_type": "syn",
    "duration": 45.2,
    "timestamp": "2025-10-06T12:00:00Z"
  }
}
```

### 7.3 èµ„äº§æ”¶é›†ç±»æ’ä»¶è¾“å‡º

å‚è€ƒ `asset_collector` çš„è¾“å‡ºæ ¼å¼ï¼š

```json
{
  "status": "success",
  "message": "èµ„äº§æ”¶é›†å®Œæˆ",
  "data": {
    "enterprise": {
      "name": "äº¬ä¸œé›†å›¢",
      "unified_code": "91110000802940206A",
      "legal_person": "åˆ˜å¼ºä¸œ",
      "establish_date": "2007-04-20",
      // ... æ›´å¤šä¼ä¸šä¿¡æ¯
    },
    "subdomains": [
      {
        "domain": "www.jd.com",
        "ips": ["103.235.46.39"],
        "http_code": 200,
        "title": "äº¬ä¸œ(JD.COM)-æ­£å“ä½ä»·...",
        "cdn": false
      }
    ],
    "ips": [
      {
        "ip": "103.235.46.39",
        "cdn": false,
        "open_ports": [80, 443],
        "services": ["http", "https"],
        "location": "åŒ—äº¬å¸‚"
      }
    ],
    "urls": [],
    "crawlers": []
  },
  "metadata": {
    "modules": ["enterprise", "subdomain", "ip", "url", "crawler"],
    "total_assets": 5,
    "processed_assets": 5,
    "duration": 308.5
  }
}
```

### 7.4 é”™è¯¯è¾“å‡º

```json
{
  "status": "error",
  "message": "æ‰«æå¤±è´¥ï¼šè¿æ¥è¶…æ—¶",
  "error": {
    "code": "TIMEOUT",
    "details": "è¿æ¥ç›®æ ‡ 192.168.1.1:80 è¶…æ—¶ï¼ˆ30ç§’ï¼‰",
    "suggestion": "è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–å¢åŠ è¶…æ—¶æ—¶é—´"
  },
  "metadata": {
    "timestamp": "2025-10-06T12:00:00Z"
  }
}
```

---

## 8. è°ƒè¯•ä¸æµ‹è¯•

### 8.1 æœ¬åœ°è°ƒè¯•

**æ–¹å¼1ï¼šç›´æ¥è¿è¡Œ**

```bash
cd plugins/my_plugin
go run main.go example.com
```

**æ–¹å¼2ï¼šç¼–è¯‘åè¿è¡Œ**

```bash
go build -o my_plugin main.go
./my_plugin example.com
```

**æ–¹å¼3ï¼šä½¿ç”¨è°ƒè¯•å™¨**

```bash
# VS Code launch.json
{
  "version": "0.2.0",
  "configurations": [
    {
      "name": "Debug Plugin",
      "type": "go",
      "request": "launch",
      "mode": "debug",
      "program": "${workspaceFolder}/main.go",
      "args": ["example.com"]
    }
  ]
}
```

### 8.2 é›†æˆæµ‹è¯•

**æ¨¡æ‹ŸWorkerè°ƒç”¨ï¼š**

```bash
# è®¾ç½®ç¯å¢ƒå˜é‡
export HS_SCAN_ID=test-scan-001
export HS_GATEWAY_URL=http://localhost:8080

# è¿è¡Œæ’ä»¶
cd plugins/my_plugin
go run main.go example.com 2>debug.log
```

**æŸ¥çœ‹æ—¥å¿—ï¼š**

```bash
# æŸ¥çœ‹è¿›åº¦æ—¥å¿—ï¼ˆstderrï¼‰
cat debug.log

# æŸ¥çœ‹ç»“æœï¼ˆstdoutï¼‰
go run main.go example.com | jq .
```

### 8.3 å•å…ƒæµ‹è¯•

```go
// tests/scanner_test.go
package tests

import (
	"testing"
)

func TestScanner(t *testing.T) {
	target := "example.com"
	result, err := scanner.Scan(target)
	
	if err != nil {
		t.Fatalf("æ‰«æå¤±è´¥: %v", err)
	}
	
	if result.Status != "success" {
		t.Errorf("æœŸæœ› successï¼Œå®é™… %s", result.Status)
	}
}
```

è¿è¡Œæµ‹è¯•ï¼š

```bash
go test ./tests/...
```

### 8.4 æ€§èƒ½æµ‹è¯•

```bash
# åŸºå‡†æµ‹è¯•
go test -bench=. -benchmem

# å‹åŠ›æµ‹è¯•
for i in {1..100}; do
  ./my_plugin example.com &
done
wait
```

---

## 9. æ‰“åŒ…ä¸å‘å¸ƒ

### 9.1 æ‰“åŒ…å‰æ£€æŸ¥

**æ£€æŸ¥æ¸…å•ï¼š**

- [ ] æ‰€æœ‰æ–‡ä»¶ç¼–ç ä¸º UTF-8
- [ ] metadata.json æ ¼å¼æ­£ç¡®
- [ ] README.md å®Œæ•´
- [ ] åˆ é™¤è°ƒè¯•ä»£ç å’Œæ—¥å¿—
- [ ] ç‰ˆæœ¬å·å·²æ›´æ–°
- [ ] æµ‹è¯•é€šè¿‡
- [ ] æ— æ•æ„Ÿä¿¡æ¯ï¼ˆå¯†ç ã€å¯†é’¥ï¼‰

### 9.2 åˆ›å»º ZIP åŒ…

**è‡ªåŠ¨æ‰“åŒ…ï¼ˆæ¨èï¼‰ï¼š**

```bash
# åœ¨æ’ä»¶ç›®å½•æ‰§è¡Œ
cd plugins/my_plugin
zip -r my_plugin_v1.0.0.zip . \
  -x "*.git*" \
  -x "output/*" \
  -x "*.log" \
  -x "*.tmp"
```

**åŒ…å«çš„æ–‡ä»¶ï¼š**

```
my_plugin_v1.0.0.zip
â”œâ”€â”€ main.go
â”œâ”€â”€ go.mod
â”œâ”€â”€ go.sum
â”œâ”€â”€ metadata.json
â”œâ”€â”€ config.json
â”œâ”€â”€ README.md
â”œâ”€â”€ CHANGELOG.md
â”œâ”€â”€ config/
â”œâ”€â”€ modules/
â”œâ”€â”€ types/
â””â”€â”€ utils/
```

**æ’é™¤çš„æ–‡ä»¶ï¼š**
- `.git/`
- `output/`
- `*.log`
- `*.tmp`
- æµ‹è¯•æ•°æ®

### 9.3 ä¸Šä¼ æ’ä»¶

**æ–¹å¼1ï¼šé€šè¿‡Webç•Œé¢ä¸Šä¼ **

1. ç™»å½• Hidden Shield
2. å¯¼èˆªåˆ° **é…ç½®ç®¡ç† â†’ æ’ä»¶ç®¡ç†**
3. ç‚¹å‡» **ä¸Šä¼ æ’ä»¶**
4. é€‰æ‹© ZIP æ–‡ä»¶
5. ç­‰å¾…ä¸Šä¼ å’ŒéªŒè¯

**æ–¹å¼2ï¼šé€šè¿‡APIä¸Šä¼ **

```bash
curl -X POST http://localhost:8080/api/plugins/upload \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -F "file=@my_plugin_v1.0.0.zip"
```

**æ–¹å¼3ï¼šæ‰‹åŠ¨å¤åˆ¶ï¼ˆå¼€å‘ç¯å¢ƒï¼‰**

```bash
# å¤åˆ¶åˆ°ç³»ç»Ÿæ’ä»¶ç›®å½•
cp -r plugins/my_plugin data/plugins/

# é‡å¯Worker
cd backend && go run ./cmd/worker/
```

### 9.4 ç‰ˆæœ¬ç®¡ç†

**è¯­ä¹‰åŒ–ç‰ˆæœ¬ï¼ˆSemVerï¼‰ï¼š**

```
ä¸»ç‰ˆæœ¬å·.æ¬¡ç‰ˆæœ¬å·.ä¿®è®¢å·

1.0.0 â†’ 1.0.1  ä¿®å¤bug
1.0.1 â†’ 1.1.0  æ–°å¢åŠŸèƒ½
1.1.0 â†’ 2.0.0  ç ´åæ€§å˜æ›´
```

**CHANGELOG.md ç¤ºä¾‹ï¼š**

```markdown
# æ›´æ–°æ—¥å¿—

## [1.2.0] - 2025-10-06

### æ–°å¢
- æ”¯æŒUDPæ‰«æ
- æ–°å¢æœåŠ¡æŒ‡çº¹è¯†åˆ«

### ä¼˜åŒ–
- æ‰«æé€Ÿåº¦æå‡30%
- å‡å°‘å†…å­˜å ç”¨

### ä¿®å¤
- ä¿®å¤å¹¶å‘ç«äº‰æ¡ä»¶
- ä¿®å¤è¶…æ—¶ä¸ç”Ÿæ•ˆçš„bug

## [1.1.0] - 2025-09-01
...
```

---

## 10. æœ€ä½³å®è·µ

### 10.1 ä»£ç è§„èŒƒ

**âœ… æ¨èï¼š**

```go
// ä½¿ç”¨æœ‰æ„ä¹‰çš„å˜é‡å
scanResults := performScan(target)

// æ·»åŠ è¯¦ç»†æ³¨é‡Š
// ScanPort æ‰«ææŒ‡å®šç«¯å£å¹¶è¿”å›æœåŠ¡ä¿¡æ¯
func ScanPort(ip string, port int) (*PortInfo, error) {
	// ...
}

// é”™è¯¯å¤„ç†
if err != nil {
	log.Printf("ERROR: æ‰«æå¤±è´¥ - %v", err)
	return nil, fmt.Errorf("æ‰«æç«¯å£ %d å¤±è´¥: %w", port, err)
}

// ä½¿ç”¨å¸¸é‡
const (
	DefaultTimeout = 30 * time.Second
	MaxRetries     = 3
)
```

**âŒ é¿å…ï¼š**

```go
// ä¸è¦ä½¿ç”¨å•å­—æ¯å˜é‡ï¼ˆé™¤äº†å¾ªç¯ï¼‰
r := scan(t)

// ä¸è¦å¿½ç•¥é”™è¯¯
scan(target)  // æ²¡æœ‰æ£€æŸ¥é”™è¯¯

// ä¸è¦ç¡¬ç¼–ç 
time.Sleep(30 * time.Second)  // åº”è¯¥ä½¿ç”¨é…ç½®
```

### 10.2 æ€§èƒ½ä¼˜åŒ–

**1. å¹¶å‘æ§åˆ¶**

```go
// ä½¿ç”¨Workeræ± 
const MaxWorkers = 50
sem := make(chan struct{}, MaxWorkers)

for _, target := range targets {
	sem <- struct{}{}
	go func(t string) {
		defer func() { <-sem }()
		scan(t)
	}(target)
}
```

**2. è¶…æ—¶æ§åˆ¶**

```go
ctx, cancel := context.WithTimeout(context.Background(), 30*time.Second)
defer cancel()

select {
case result := <-resultChan:
	return result, nil
case <-ctx.Done():
	return nil, fmt.Errorf("æ“ä½œè¶…æ—¶")
}
```

**3. èµ„æºæ¸…ç†**

```go
// ä½¿ç”¨deferç¡®ä¿èµ„æºé‡Šæ”¾
conn, err := net.Dial("tcp", addr)
if err != nil {
	return err
}
defer conn.Close()
```

### 10.3 å®‰å…¨æœ€ä½³å®è·µ

**1. è¾“å…¥éªŒè¯**

```go
// éªŒè¯IPåœ°å€
ip := net.ParseIP(input)
if ip == nil {
	return fmt.Errorf("æ— æ•ˆçš„IPåœ°å€: %s", input)
}

// éªŒè¯åŸŸå
if !isValidDomain(domain) {
	return fmt.Errorf("æ— æ•ˆçš„åŸŸå: %s", domain)
}
```

**2. é¿å…è·¯å¾„éå†**

```go
// é”™è¯¯ç¤ºä¾‹
filepath.Join(baseDir, userInput)  // ç”¨æˆ·å¯ä»¥è¾“å…¥ "../../../etc/passwd"

// æ­£ç¡®åšæ³•
cleanPath := filepath.Clean(userInput)
if strings.Contains(cleanPath, "..") {
	return fmt.Errorf("éæ³•è·¯å¾„")
}
```

**3. é™åˆ¶èµ„æºä½¿ç”¨**

```go
// é™åˆ¶è¯»å–å¤§å°
reader := io.LimitReader(resp.Body, 10*1024*1024)  // æœ€å¤š10MB

// é™åˆ¶å¹¶å‘æ•°
const MaxConcurrent = 100

// é™åˆ¶æ‰§è¡Œæ—¶é—´
ctx, cancel := context.WithTimeout(ctx, 5*time.Minute)
defer cancel()
```

### 10.4 æ—¥å¿—è§„èŒƒ

**æ—¥å¿—çº§åˆ«ï¼š**

```go
// INFO: ä¸€èˆ¬ä¿¡æ¯
fmt.Fprintf(os.Stderr, "INFO: å¼€å§‹æ‰«æ %s\n", target)

// WARN: è­¦å‘Šï¼ˆä¸å½±å“ç»§ç»­æ‰§è¡Œï¼‰
fmt.Fprintf(os.Stderr, "WARN: ç«¯å£ %d å“åº”æ…¢\n", port)

// ERROR: é”™è¯¯ï¼ˆå½±å“ç»“æœï¼‰
fmt.Fprintf(os.Stderr, "ERROR: è¿æ¥å¤±è´¥ - %v\n", err)

// DEBUG: è°ƒè¯•ä¿¡æ¯ï¼ˆä»…å¼€å‘ç¯å¢ƒï¼‰
if debugMode {
	fmt.Fprintf(os.Stderr, "DEBUG: å‘é€æ•°æ®åŒ… %v\n", packet)
}
```

**æ—¥å¿—æ ¼å¼ï¼š**

```
[æ—¶é—´æˆ³] [çº§åˆ«] [æ¨¡å—] æ¶ˆæ¯

2025-10-06 12:00:00 INFO [scanner] å¼€å§‹æ‰«æ example.com
2025-10-06 12:00:05 WARN [scanner] ç«¯å£ 22 è¶…æ—¶
2025-10-06 12:00:10 ERROR [scanner] è¿æ¥å¤±è´¥
```

### 10.5 é…ç½®ç®¡ç†

**ä½¿ç”¨é…ç½®æ–‡ä»¶è€Œéç¡¬ç¼–ç ï¼š**

```go
type Config struct {
	Timeout    int      `json:"timeout"`
	MaxWorkers int      `json:"maxWorkers"`
	Ports      []int    `json:"ports"`
	Debug      bool     `json:"debug"`
}

func LoadConfig(path string) (*Config, error) {
	data, err := os.ReadFile(path)
	if err != nil {
		return nil, err
	}
	
	var cfg Config
	if err := json.Unmarshal(data, &cfg); err != nil {
		return nil, err
	}
	
	return &cfg, nil
}
```

**æ”¯æŒç¯å¢ƒå˜é‡è¦†ç›–ï¼š**

```go
timeout := cfg.Timeout
if envTimeout := os.Getenv("SCANNER_TIMEOUT"); envTimeout != "" {
	if t, err := strconv.Atoi(envTimeout); err == nil {
		timeout = t
	}
}
```

---

## 11. å¸¸è§é—®é¢˜

### Q1: æ’ä»¶ä¸Šä¼ åæ— æ³•æ‰§è¡Œï¼Ÿ

**å¯èƒ½åŸå› ï¼š**
1. `metadata.json` æ ¼å¼é”™è¯¯
2. `runtime` æˆ– `entry` å­—æ®µé…ç½®é”™è¯¯
3. ç¼ºå°‘å¿…è¦çš„ä¾èµ–æ–‡ä»¶
4. æƒé™é…ç½®ä¸è¶³

**è§£å†³æ–¹æ³•ï¼š**
```bash
# éªŒè¯JSONæ ¼å¼
cat metadata.json | jq .

# æ£€æŸ¥å…¥å£æ–‡ä»¶
ls -la main.go

# æµ‹è¯•æœ¬åœ°è¿è¡Œ
go run main.go test-target
```

### Q2: å¦‚ä½•è°ƒè¯•æ’ä»¶æ‰§è¡Œå¤±è´¥ï¼Ÿ

**æŸ¥çœ‹Workeræ—¥å¿—ï¼š**

```bash
# å¼€å‘ç¯å¢ƒ
cd backend
go run ./cmd/worker/ 2>&1 | tee worker.log

# ç”Ÿäº§ç¯å¢ƒ
docker logs -f hidden-shield-worker
```

**æŸ¥çœ‹æ•°æ®åº“æ‰«æè®°å½•ï¼š**

```sql
SELECT * FROM scans WHERE id = 'your-scan-id';
SELECT * FROM plugin_security_scans WHERE origin_scan_id = 'your-scan-id';
```

### Q3: å¦‚ä½•å¤„ç†å¤§æ•°æ®é‡è¾“å‡ºï¼Ÿ

**åˆ†æ‰¹è¾“å‡ºï¼š**

```go
// ä¸è¦ä¸€æ¬¡æ€§åŠ è½½æ‰€æœ‰æ•°æ®åˆ°å†…å­˜
// ä½¿ç”¨æµå¼å¤„ç†
encoder := json.NewEncoder(os.Stdout)
for _, result := range scanResults {
	encoder.Encode(result)
}
```

**è¾“å‡ºæ‘˜è¦ + è¯¦ç»†æ–‡ä»¶ï¼š**

```go
// stdout è¾“å‡ºæ‘˜è¦
summary := Summary{
	Total: len(results),
	FilePath: "/tmp/detailed_results.json",
}
json.NewEncoder(os.Stdout).Encode(summary)

// è¯¦ç»†ç»“æœå†™å…¥æ–‡ä»¶
saveDetailedResults("/tmp/detailed_results.json", results)
```

### Q4: å¦‚ä½•å®ç°è¿›åº¦æ›´æ–°ï¼Ÿ

**é€šè¿‡stderrè¾“å‡ºè¿›åº¦ï¼š**

```go
total := len(targets)
for i, target := range targets {
	fmt.Fprintf(os.Stderr, "INFO: è¿›åº¦ %d/%d (%.1f%%)\n", 
		i+1, total, float64(i+1)/float64(total)*100)
	scan(target)
}
```

**é€šè¿‡APIæ›´æ–°æ•°æ®åº“ï¼š**

```go
func updateProgress(scanID string, current, total int) error {
	url := fmt.Sprintf("%s/api/scans/%s/progress", gatewayURL, scanID)
	data := map[string]int{
		"processed_assets": current,
		"total_assets": total,
	}
	// å‘é€PATCHè¯·æ±‚
	return sendPatch(url, data)
}
```

### Q5: Python/Node.js æ’ä»¶å¦‚ä½•æ‰“åŒ…ä¾èµ–ï¼Ÿ

**Pythonï¼š**

```bash
# å®‰è£…ä¾èµ–åˆ°æœ¬åœ°ç›®å½•
pip install -r requirements.txt -t ./vendor

# åœ¨ä»£ç ä¸­æ·»åŠ è·¯å¾„
import sys
sys.path.insert(0, './vendor')
```

**Node.jsï¼š**

```bash
# æ‰“åŒ…æ—¶åŒ…å« node_modules
zip -r plugin.zip . -x "*.git*"
```

### Q6: å¦‚ä½•å¤„ç†APIé™æµï¼Ÿ

**å®ç°æŒ‡æ•°é€€é¿ï¼š**

```go
func callAPIWithRetry(url string, maxRetries int) (*Response, error) {
	for i := 0; i < maxRetries; i++ {
		resp, err := http.Get(url)
		if err != nil {
			return nil, err
		}
		
		if resp.StatusCode == 429 {  // Too Many Requests
			waitTime := time.Duration(math.Pow(2, float64(i))) * time.Second
			fmt.Fprintf(os.Stderr, "WARN: APIé™æµï¼Œç­‰å¾… %v åé‡è¯•\n", waitTime)
			time.Sleep(waitTime)
			continue
		}
		
		return resp, nil
	}
	return nil, fmt.Errorf("è¾¾åˆ°æœ€å¤§é‡è¯•æ¬¡æ•°")
}
```

### Q7: å¦‚ä½•ä¸å…¶ä»–æ’ä»¶å…±äº«æ•°æ®ï¼Ÿ

**æ–¹å¼1ï¼šé€šè¿‡æ•°æ®åº“**

```go
// è¯»å–å…¶ä»–æ’ä»¶çš„ç»“æœ
var subdomains []string
db.Query("SELECT domain FROM asset_subdomains WHERE enterprise_id = ?", enterpriseID)
```

**æ–¹å¼2ï¼šé€šè¿‡æ–‡ä»¶ç³»ç»Ÿ**

```go
// å†™å…¥å…±äº«æ•°æ®
os.WriteFile("/tmp/shared_data.json", data, 0644)

// å…¶ä»–æ’ä»¶è¯»å–
data, _ := os.ReadFile("/tmp/shared_data.json")
```

**æ–¹å¼3ï¼šé€šè¿‡Gateway API**

```go
// è°ƒç”¨Gateway APIè·å–æ•°æ®
resp, _ := http.Get(gatewayURL + "/api/asset-collection/enterprises/" + enterpriseID)
```

---

## ğŸ“– å‚è€ƒèµ„æº

### å®˜æ–¹æ–‡æ¡£
- [Hidden Shield å®˜æ–¹æ–‡æ¡£](https://docs.hidden-shield.com)
- [æ’ä»¶APIå‚è€ƒ](https://docs.hidden-shield.com/api)
- [ç¤ºä¾‹æ’ä»¶ä»“åº“](https://github.com/hidden-shield/plugins)

### å¼€å‘å·¥å…·
- [æ’ä»¶éªŒè¯å·¥å…·](https://github.com/hidden-shield/plugin-validator)
- [æ’ä»¶æ¨¡æ¿ç”Ÿæˆå™¨](https://github.com/hidden-shield/plugin-generator)
- [æ’ä»¶å¸‚åœº](https://market.hidden-shield.com)

### ç¤¾åŒº
- [å¼€å‘è€…è®ºå›](https://forum.hidden-shield.com)
- [GitHub Discussions](https://github.com/hidden-shield/hidden-shield/discussions)
- [æŠ€æœ¯æ”¯æŒ](mailto:support@hidden-shield.com)

---

## ğŸ“ é™„å½•

### A. å®Œæ•´çš„Goæ’ä»¶æ¨¡æ¿

å‚è§ï¼š[templates/go-plugin-template.zip](../templates/go-plugin-template.zip)

### B. å®Œæ•´çš„Pythonæ’ä»¶æ¨¡æ¿

å‚è§ï¼š[templates/python-plugin-template.zip](../templates/python-plugin-template.zip)

### C. metadata.json JSON Schema

å‚è§ï¼š[schemas/metadata.schema.json](../schemas/metadata.schema.json)

---

**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.0.0  
**æœ€åæ›´æ–°**ï¼š2025-10-06  
**è´¡çŒ®è€…**ï¼šHidden Shield Team

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ [GitHub Issues](https://github.com/hidden-shield/hidden-shield/issues) åé¦ˆã€‚

